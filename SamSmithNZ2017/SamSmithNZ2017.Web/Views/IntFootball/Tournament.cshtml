@{
    ViewBag.Title = "Tournament Details";
    Layout = "~/Views/Shared/_LayoutIntFootball.cshtml";
}

<div ng-controller="tournamentController">

    <div class="row">
        <div class="col-md-12">
            <img ng-src="~/Content/IntFootball/WorldCupLogos/{{tournament.LogoImage}}" />
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <b>Details:</b><br />
            Host country:
            <img ng-src="~/Content/IntFootball/Teams/{{tournament.HostFlagName}}" class="TeamImage" />
            <a href="/IntFootball/Team?teamCode={{tournament.HostTeamCode}}">{{tournament.HostTeamName}}</a>
            <span ng-if="tournament.CoHostTeamCode > 0">/ </span>
            <img ng-src="~/Content/IntFootball/Teams//{{tournament.CoHostFlagName}}" class="TeamImage" ng-if="tournament.CoHostTeamCode > 0" />
            <a href="/IntFootball/Team?teamCode={{tournament.CoHostTeamCode}}" ng-if="tournament.CoHostTeamCode > 0">{{tournament.CoHostTeamName}}</a>
            <span ng-if="tournament.CoHostTeamCode2 > 0">/ </span>
            <img ng-src="~/Content/IntFootball/Teams//{{tournament.CoHostFlagName2}}" class="TeamImage" ng-if="tournament.CoHostTeamCode2 > 0" />
            <a href="/IntFootball/Team?teamCode={{tournament.CoHostTeamCode2}}" ng-if="tournament.CoHostTeamCode2 > 0">{{tournament.CoHostTeamName2}}</a>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            Dates:
            <span ng-if="tournament.MinGameTime != null">{{tournament.MinGameTime | date:'dd-MMMM-yyyy'}} to {{tournament.MaxGameTime | date:'dd-MMMM-yyyy'}}</span>
            <span ng-if="tournament.MinGameTime == null">Sometime in {{tournament.TournamentYear}}</span>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            Teams: {{tournament.R1NumberOfGroupsInRound * tournament.R1NumberOfTeamsInGroup}}
            <br /><br />
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <b>Stages:</b><br />

            <div ng-repeat="roundNumber in [1, 2, 3]">
                <div ng-if="roundNumber == 1 && tournament.R1FormatRoundCode > 0 && tournament.R1IsGroupStage == true">
                    <span>Round {{roundNumber}}: {{tournament.R1NumberOfGroupsInRound * tournament.R1NumberOfTeamsInGroup}} teams split in {{tournament.R1NumberOfGroupsInRound}} groups of {{tournament.R1NumberOfTeamsInGroup}}.</span><br />
                    <span ng-repeat="groupNumber in R1GroupArray" ng-if="tournament.MinGameTime != null">
                        <a href="/IntFootball/Group?tournamentCode={{tournament.TournamentCode}}&roundNumber={{roundNumber}}&roundCode={{getCharacter(tournament.R1FirstGroupCode.charCodeAt(0) + groupNumber - 1)}}">Group {{getCharacter(tournament.R1FirstGroupCode.charCodeAt(0) + groupNumber - 1)}}</a>
                        <span ng-if="groupNumber < tournament.R1NumberOfGroupsInRound"> | </span>
                    </span>
                </div>
                <div ng-if="roundNumber == 1 && tournament.R1FormatRoundCode > 0 && tournament.R1IsGroupStage == false">
                    <span>Round {{roundNumber}}: {{tournament.R1NumberOfTeamsInGroup}} Team Playoff</span><br />
                    <a href="/IntFootball/Playoffs?tournamentCode={{tournament.TournamentCode}}&roundNumber={{roundNumber}}" ng-if="tournament.MinGameTime != null">Playoffs</a>
                    <br />
                </div>

                <div ng-if="roundNumber == 2 && tournament.R2FormatRoundCode > 0 && tournament.R2IsGroupStage == true">
                    <span>Round {{roundNumber}}: {{tournament.R2NumberOfGroupsInRound * tournament.R2NumberOfTeamsInGroup}} teams split in {{tournament.R2NumberOfGroupsInRound}} groups of {{tournament.R2NumberOfTeamsInGroup}}.</span><br />
                    <span ng-repeat="groupNumber in R2GroupArray" ng-if="tournament.MinGameTime != null">
                        <a href="/IntFootball/Group?tournamentCode={{tournament.TournamentCode}}&roundNumber={{roundNumber}}&roundCode={{getCharacter(tournament.R2FirstGroupCode.charCodeAt(0) + groupNumber - 1)}}">Group {{getCharacter(tournament.R2FirstGroupCode.charCodeAt(0) + groupNumber - 1)}}</a>
                        <span ng-if="groupNumber < tournament.R2NumberOfGroupsInRound"> | </span>
                    </span>
                </div>
                <div ng-if="roundNumber == 2 && tournament.R2FormatRoundCode > 0 && tournament.R2IsGroupStage == false">
                    <span>Round {{roundNumber}}: {{tournament.R2NumberOfTeamsInGroup}} Team Playoff</span><br />
                    <a href="/IntFootball/Playoffs?tournamentCode={{tournament.TournamentCode}}&roundNumber={{roundNumber}}" ng-if="tournament.MinGameTime != null">Playoffs</a>
                    <br />
                </div>

                <div ng-if="roundNumber == 3 && tournament.R3FormatRoundCode > 0 && tournament.R3IsGroupStage == true">
                    <span>Round {{roundNumber}}: {{tournament.R3NumberOfGroupsInRound * tournament.R3NumberOfTeamsInGroup}} teams split in {{tournament.R3NumberOfGroupsInRound}} groups of {{tournament.R3NumberOfTeamsInGroup}}.</span><br />
                    <span ng-repeat="groupNumber in R3GroupArray" ng-if="tournament.MinGameTime != null">
                        <a href="/IntFootball/Group?tournamentCode={{tournament.TournamentCode}}&roundNumber={{roundNumber}}&roundCode={{getCharacter(tournament.R3FirstGroupCode.charCodeAt(0) + groupNumber - 1)}}">Group {{getCharacter(tournament.R3FirstGroupCode.charCodeAt(0) + groupNumber - 1)}}</a>
                        <span ng-if="groupNumber < tournament.R3NumberOfGroupsInRound"> | </span>
                    </span>
                </div>
                <div ng-if="roundNumber == 3 && tournament.R3FormatRoundCode > 0 && tournament.R3IsGroupStage == false">
                    <span>Round {{roundNumber}}: {{tournament.R3NumberOfTeamsInGroup}} Team Playoff</span><br />
                    <a href="/IntFootball/Playoffs?tournamentCode={{tournament.TournamentCode}}&roundNumber={{roundNumber}}" ng-if="tournament.MinGameTime != null">Playoffs</a>
                    <br />
                </div>
            </div>
            <br />
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <b>Notes:</b><br />
            <div ng-bind="tournament.Notes"></div>
            <br />
            <br />
        </div>
    </div>

    @*<div class="row">
            <div class="col-md-12">
                <b>Statistics:</b><br />
                Matches played: <asp:label id="lblNumberOfGames" runat="server"></asp:label><br />
                Goals scored: <asp:label id="lblTotalGoalsScored" runat="server"></asp:label>(<asp:label id="lblAverageGoals" runat="server"></asp:label> per match)
            </div>
        </div>*@


    <div class="row">
        <div class="col-md-12">
            <b>Qualification:</b>
            <br />
            <img ng-src="~/Content/IntFootball/WorldCupQualification/{{tournament.QualificationImage}}" />
            <span style="padding-bottom: 1px; margin: 0px; display: block; font-size: 90%">
                <span style="border-bottom: #000cff 1px solid; border-left: #000cff 1px solid; background-color: #000cff; color: #000cff; border-top: #000cff 1px solid; border-right: #000cff 1px solid">&nbsp;&nbsp;&nbsp;&nbsp;</span> &nbsp;Countries qualified for World Cup
            </span>
            <span style="padding-bottom: 1px; margin: 0px; display: block; font-size: 90%">
                <span style="border-bottom: #ffb400 1px solid; border-left: #ffb400 1px solid; background-color: #ffb400; color: #ffb400; border-top: #ffb400 1px solid; border-right: #ffb400 1px solid">&nbsp;&nbsp;&nbsp;&nbsp;</span> &nbsp;Country failed to qualify
            </span>
            <span style="padding-bottom: 1px; margin: 0px; display: block; font-size: 90%">
                <span style="border-bottom: black 1px solid; border-left: black 1px solid; background-color: black; color: black; border-top: black 1px solid; border-right: black 1px solid">&nbsp;&nbsp;&nbsp;&nbsp;</span> &nbsp;Countries that did not enter World Cup
            </span>
            <span style="padding-bottom: 1px; margin: 0px; display: block; font-size: 90%"><span style="border-bottom: #ababab 1px solid; border-left: #ababab 1px solid; background-color: #ababab; color: #ababab; border-top: #ababab 1px solid; border-right: #ababab 1px solid">&nbsp;&nbsp;&nbsp;&nbsp;</span> &nbsp;Country not a FIFA member</span>
            <br /><br />
        </div>
    </div>

    <div class="row">

        <div class="col-md-6">
            <b ng-if="tournament != null && tournament.TournamentCode <= 21">Team Placing:</b>
            <b ng-if="tournament == null || tournament.TournamentCode > 21">Qualified Teams:</b>
            <table class="table table-striped table-bordered">
                <tr>
                    <th>Placing</th>
                    <th>Team</th>
                    <th ng-if="ChanceToWin && tournamentTeams.length > 0 && tournamentTeams[0].ChanceToWin < 100">Chance to win</th>
                    <th ng-if="tournamentTeams.length > 0 && tournamentTeams[0].StartingEloRating > 0">Starting ELO Rating</th>
                    <th ng-if="tournamentTeams.length > 0 && tournamentTeams[0].ELORating > 0">Current ELO Rating</th>
                    @*<th>Coach</th>*@
                    <th>GF</th>
                    <th>GA</th>
                    <th>GD</th>
                    <th>Region</th>
                </tr>
                <tr ng-repeat="item in tournamentTeams">
                    <td><span ng-if="item.Placing != 0">{{item.Placing}}</span></td>
                    <td>
                        <img ng-src="~/Content/IntFootball/Teams/{{item.FlagName}}" Class="TeamImage" />
                        <a href="/IntFootball/Team?teamCode={{item.TeamCode}}">
                            {{item.TeamName}}
                        </a>
                    </td>
                    <td ng-if="ChanceToWin && item.ChanceToWin > 0 && tournamentTeams[0].ChanceToWin < 100">
                        {{item.ChanceToWin | number: 1}}%
                    </td>
                    <td ng-if="ChanceToWin && item.ChanceToWin == 0 && tournamentTeams[0].ChanceToWin < 100"></td>
                    <td ng-if="item.StartingEloRating > 0">{{item.StartingEloRating}}</td>
                    <td ng-if="item.ELORating > 0">{{item.ELORating}} ({{item.ELORatingDifference}})</td>
                    @*<td>
            <img ng-src="~/Content/IntFootball/Teams/{{item.CoachNationalityFlagName}}" Class="TeamImage" ng-if="item.CoachNationalityFlagName != ''" />
            {{item.CoachName}}
        </td>*@
                    <td>{{item.GF}}</td>
                    <td>{{item.GA}}</td>
                    <td>{{item.GD}}</td>
                    <td>{{item.RegionName}}</td>
                </tr>
            </table>
        </div>

        <div class="col-md-6">
            <b>Top goal scorers:</b> (bold indicates the player's team is still in the tournament)
            <br /><br />
            <div ng-repeat="item in tournamentTopGoalScorersAdjusted">
                <span ng-if="item.Goals > 1"><b>{{item.Goals}} goals</b></span>
                <span ng-if="item.Goals == 1"><b>{{item.Goals}} goal</b></span>
                <br />
                <div class="row">
                    <div class="col-sm-12">
                        <div class="col-sm-3" ng-repeat="player in item.Players">
                            &bull;<a href="/IntFootball/Team?teamCode={{player.TeamCode}}">
                                <img ng-src="~/Content/IntFootball/Teams/{{player.FlagName}}" Class="TeamImage" />
                            </a>
                            <span ng-if="player.IsActive"><b>&nbsp;{{player.PlayerName}}&nbsp;</b></span>
                            <span ng-if="!player.IsActive">&nbsp;{{player.PlayerName}}&nbsp;</span>
                        </div>
                    </div>
                </div>
                <br />
            </div>
            @*<table class="table table-striped table-bordered">
                    <tr>
                        <th>Player</th>
                        <th>Goals Scored</th>
                        <th>Team</th>
                    </tr>
                    <tr ng-repeat="item in tournamentTopGoalScorers">
                        <td>{{item.PlayerName}}</td>
                        <td>{{item.GoalsScored}}</td>
                        <td>
                            <img ng-src="~/Content/IntFootball/Teams/{{item.FlagName}}" Class="TeamImage" />
                            <a href="/IntFootball/Team?teamCode={{item.TeamCode}}">{{item.TeamName}}</a>
                        </td>
                    </tr>
                </table>*@
        </div>
    </div>

</div>
